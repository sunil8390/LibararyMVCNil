@*@model LibararyMVCNil.DAL.Books*@
@*@model IEnumerable<LibararyMVCNil.ViewModel.BooksViewModel>*@

@model LibararyMVCNil.ViewModel.BooksViewModel

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>SearchBook1</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
   
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .main {
            display: flex;
            margin: 4rem;
        }

        .sub_main {
            padding-right: 40px;
        }



        h1 {
            background-color: #F5F5DC;
            padding: 10px;
            text-align: center;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 600;
        }
    </style>

</head>
<body>

    <div class="col-lg-12"><h1> Search library Books</h1> </div>


    @using (Html.BeginForm("get_data", "Books", FormMethod.Get))
    {

        <form>
            <div class="main">
                <div class="sub_main">
                    <label><b>Book Name</b></label>
                    @Html.TextBoxFor(model => model.BookName, new { @class = "form-control" })

                </div>

                <div class="sub_main">
                    <label><b>Category Type</b></label>
                    @Html.DropDownListFor(model => model.CategoryId, new SelectList(Model.categorylist, "CategoryId", "CategoryName"), "Select Category", new { @class = "form-control" })

                </div>
                <div class="sub_main">
                    <label><b>Publihser Name</b></label>
                    @Html.DropDownListFor(model => model.PublisherId, new SelectList(Model.publisherlist, "PublisherId", "PublisherName"), "Select Publisher", new { @class = "form-control" })

                </div>


                <div class="sub_main">
                    <label><b>PageNumber</b></label>
                    @Html.TextBoxFor(model => model.PageNumber, new { @class = "form-control" })

                </div>
                <div class="sub_main">
                    <label><b>RowsOfPage</b></label>

                    @Html.DropDownListFor(model => model.RowsOfPage, new SelectList(Model.PageRange), " Please Select Page Range", new { @class = "form-control" })
                </div>



                <div class="sub_main">

                    <input type="button" onclick="BtnClick()" name="name" value="Search" class="btn btn-outline-success" style="margin-top:24px" />

                </div>
                <div class="sub_main">

                    <input type="reset"  onclick="BtnClick()" value="Reset" class="btn btn-outline-info" style="margin-top:24px" />

                </div>
            </div>
        </form>

    }

<div class="container-fluid">
    <table class="table table-hover">
        <thead class="table table-dark">
            <tr>
                <th>BookId</th>
                <th>BookName</th>
                <th>CategoryName</th>
                <th>PublisherName</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody id="listdiv">
        </tbody>
    </table>
</div>

    

 





    <script>

        $(document).ready(function () {

          
            BtnClick();

            });



        function BtnClick() {
            debugger;

            //let modelObj = {
            //    BookName: $("#BookName").val(),
            //    CategoryId: $("#CategoryId").val(),
            //    PublisherId: $("#PublisherId").val(),
            //    PageNumber: $("#PageNumber").val(),
            //    RowsOfPage: $("#RowsOfPage").val()
            //}




            $.ajax
                ({
                    url: "/Books/get_data",
                    method: "POST",

                    //data: { BookName: BookName, CategoryId: CategoryId, PublisherId: PublisherId, PageNumber: PageNumber, RowsOfPage: RowsOfPage },

                    /*  data: JSON.stringify(modelObj),*/


                    //data:  BookName= $("#BookName") + CategoryId= $("#CategoryId") + PublisherId= $("#PublisherId") + PageNumber= $("#PageNumber") + RowsOfPage = $("#RowsOfPage").val(),


                    data:
                    {
                        BookName: $("#BookName").val(),
                        CategoryId: $("#CategoryId").val(),
                        PublisherId: $("#PublisherId").val(),
                        PageNumber: $("#PageNumber").val(),
                        RowsOfPage: $("#RowsOfPage").val(),
                        Quantity: $("#Quantity").val()
                    },  
                    success: function (data) {
                           /*  console.log(data);*/
                        //data = JSON.parse(data);

                        var strtable = "<table>" /* <tr><th>BookId</th><th>BookName</th><th>CategoryName</th><th>PublisherName</th></tr>";*/
                        //for (i = 0; i < data.length; i++) {
                        //    strtable = strtable + "<tr><td>"
                        $.each(data, function (i, v1) {
                            strtable +=
                                "<tr><td>" + v1.BookId + "</td><td>" + v1.BookName + "</td><td>" + v1.CategoryName + "</td><td>" + v1.PublisherName + "</td><td>" + v1.Quantity + "</td></tr>";


                        });
                        strtable += "</table>";
                        $('#listdiv').html(strtable);



                    },

                    error: function (err) {
                        alert("Please Select Correct value in Page Number and Page Row ");
                    }
                })
        }
    </script>










    @*using jqury ajax 1*@
    @*<div>
                <table id="tbldata" class="tableData">
                    <tr>BookId</tr>
                    <tr>Book Name</tr>
                    <tr>Category Name</tr>
                    <tr>Publisher Name</tr>
                </table>
            </div>
        <script>
            $(function () {
                $.get("get_data", {}, function (data) {
                var row;
                    $.each(data, function (i, v1) {
                    row + "<tr><td>" + v1.BookId + "</td><td>" + v1.BookName + "</td><td>" + v1.CategoryName + "</td><td>" + v1.PublisherName + "</td></tr>"
                    }
            });
                $("#tbldata").append(row);
        })
        </script>*@






    @*show data using simple table*@
    @*<div class="container-fluid">
            <table class="table table-hover">
                <tr>
                    <th>BookId</th>
                    <th>Book Name</th>
                    <th>Category Name</th>
                    <th>Publisher Name</th>
                </tr>
                @foreach (var a in Model.booklist)
                {
                    <tr>
                        <td>@Html.DisplayFor(modelitem => a.BookId) </td>
                        <td>@Html.DisplayFor(modelitem => a.BookName) </td>
                        <td>@Html.DisplayFor(modelitem => a.CategoryName) </td>
                        <td>@Html.DisplayFor(modelitem => a.PublisherName) </td>
                    </tr>
                }
            </table>
        </div>*@



    @*paging*@

    @*@for (int i = 1; i <= Model.TotalPages; i++)
        {
            <ul>
                <li>@Html.ActionLink(@i.ToString(), "SearchBook1", "Books", new { page = @i } )</li>
            </ul>
        }*@

    @*paging*@
    @*<div class="container-fluid">
            @for (int a = 1; a < Convert.ToInt32(Model.TotalPages) + 1; a++)
            {
                <a href="@Url.Action("SearchBook1", "Books",new { pager=a   })">@a.ToString()</a>
            }
        </div>*@






</body>
</html>